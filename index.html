<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RANZZ_JB - Pro System v2</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root {
            --primary: #6366f1;
            --danger: #ff4d4d;
            --success: #00ff88;
            --bg: #0f172a;
            --card-bg: #1e293b;
            --text-main: #f8fafc;
            --text-sub: #94a3b8;
            --nav-bg: rgba(30, 41, 59, 0.7);
        }

        [data-theme="light"] {
            --bg: #f1f5f9;
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-sub: #64748b;
            --nav-bg: rgba(255, 255, 255, 0.8);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; transition: all 0.3s ease; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg); color: var(--text-main); overflow-x: hidden; }

        /* Notifikasi */
        #custom-alert {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px);
            padding: 12px 25px; border-radius: 15px; z-index: 4000;
            display: flex; align-items: center; gap: 10px; font-weight: 700;
            backdrop-filter: blur(10px); opacity: 0; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        #custom-alert.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .alert-error { background: rgba(255, 77, 77, 0.2); border: 1px solid var(--danger); color: var(--danger); }
        .alert-success { background: rgba(0, 255, 136, 0.2); border: 1px solid var(--success); color: var(--success); }

        /* Navigasi */
        nav {
            position: fixed; top: 0; width: 100%; padding: 1rem 5%;
            background: var(--nav-bg); backdrop-filter: blur(15px);
            display: flex; justify-content: space-between; align-items: center;
            z-index: 1000; border-bottom: 1px solid rgba(125,125,125,0.1);
        }

        /* AI Floating Button */
        #ai-btn {
            position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px;
            background: var(--primary); border-radius: 50%; display: flex;
            align-items: center; justify-content: center; font-size: 1.5rem;
            cursor: pointer; box-shadow: 0 10px 20px rgba(99, 102, 241, 0.4); z-index: 2000;
        }

        /* AI Chat Box */
        #ai-chat {
            position: fixed; bottom: 100px; right: 30px; width: 320px; height: 500px;
            background: var(--card-bg); border-radius: 20px; border: 1px solid rgba(125,125,125,0.2);
            display: none; flex-direction: column; z-index: 2000; overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .chat-header { background: var(--primary); padding: 15px; color: white; font-weight: 800; display: flex; justify-content: space-between; align-items: center; }
        #chat-content { flex: 1; padding: 15px; overflow-y: auto; font-size: 0.85rem; display: flex; flex-direction: column; gap: 10px; }
        
        .msg-ai { background: var(--bg); padding: 10px; border-radius: 0 15px 15px 15px; align-self: flex-start; max-width: 85%; border: 1px solid rgba(125,125,125,0.1); line-height: 1.4; }
        .msg-user { background: var(--primary); color: white; padding: 10px; border-radius: 15px 15px 0 15px; align-self: flex-end; max-width: 85%; }

        /* Quick Buttons AI */
        .quick-box { display: flex; flex-wrap: wrap; gap: 5px; padding: 10px; background: var(--card-bg); border-top: 1px solid rgba(125,125,125,0.1); }
        .q-btn { background: rgba(99, 102, 241, 0.1); border: 1px solid var(--primary); color: var(--primary); padding: 5px 10px; border-radius: 20px; font-size: 0.75rem; cursor: pointer; }

        .chat-input { display: flex; padding: 12px; background: var(--bg); gap: 8px; }
        .chat-input input { flex: 1; padding: 10px; border-radius: 10px; border: none; outline: none; background: var(--card-bg); color: var(--text-main); }
        .chat-input button { background: var(--primary); border: none; color: white; padding: 0 15px; border-radius: 10px; cursor: pointer; }

        /* Modal Styles */
        .modal-custom { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(8px); display: flex; align-items: center; justify-content: center; z-index: 3000; }
        .modal-box { background: var(--card-bg); padding: 30px; border-radius: 25px; width: 90%; max-width: 400px; border: 1px solid rgba(125,125,125,0.2); }
        .modal-box input, .modal-box textarea { width: 100%; padding: 12px; margin: 8px 0; border-radius: 12px; border: 1px solid rgba(125,125,125,0.2); background: var(--bg); color: var(--text-main); }

        .hero { padding: 120px 5% 40px; text-align: center; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 5%; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .product-card { background: var(--card-bg); border-radius: 20px; padding: 20px; border: 1px solid rgba(125,125,125,0.1); }
        .btn-buy { width: 100%; padding: 12px; border-radius: 12px; border: none; background: var(--primary); color: white; font-weight: 800; cursor: pointer; }
        .hidden { display: none; }
    </style>
</head>
<body data-theme="dark">

    <div id="custom-alert">
        <span id="alert-text"></span>
    </div>

    <nav>
        <div style="font-size: 1.3rem; font-weight: 800; color: #818cf8;">RANZZ_JB</div>
        <div style="display: flex; align-items: center; gap: 15px;">
            <button onclick="toggleTheme()" id="theme-btn" style="background:none; border:none; font-size: 1.2rem; cursor:pointer;">üåô</button>
            <div id="nav-actions">
                <button id="btn-login-init" onclick="openAuth()" style="background: var(--primary); color:white; border:none; padding: 8px 20px; border-radius: 10px; font-weight:800; cursor:pointer;">Login</button>
                <div id="user-info" class="hidden" onclick="openProfile()" style="cursor: pointer; display: flex; align-items: center; gap: 8px; background: rgba(125,125,125,0.1); padding: 5px 12px; border-radius: 10px;">
                    <span id="user-name" style="font-weight: 700; font-size: 0.9rem;"></span>
                    <span>‚öôÔ∏è</span>
                </div>
            </div>
        </div>
    </nav>

    <header class="hero">
        <h1 style="font-size: 2.5rem; font-weight: 800; color: var(--primary);">SYSTEM PRO JB</h1>
        <p style="color: var(--text-sub);">Platform Jual Beli Akun Digital & Top Up</p>
    </header>

    <main class="container">
        <div class="product-grid">
            <div class="product-card">
                <h3>Akun E-Football Mythic</h3>
                <p style="color: var(--text-sub); margin: 10px 0;">Squad GG Messi 101 + Epic.</p>
                <div style="font-size: 1.5rem; font-weight: 800; color: var(--success); margin-bottom: 15px;">Rp 200k</div>
                <button class="btn-buy" onclick="orderViaGmail('Akun Mythic', '200rb')">Beli Sekarang</button>
            </div>
        </div>
    </main>

    <div id="ai-btn" onclick="toggleChat()">ü§ñ</div>
    <div id="ai-chat">
        <div class="chat-header">
            <span>RANZZ-AI HELP CENTER</span>
            <span onclick="toggleChat()" style="cursor:pointer; font-size: 1.5rem;">&times;</span>
        </div>
        <div id="chat-content">
            <div class="msg-ai">Halo! Saya RANZZ-AI. Ada yang bisa saya bantu terkait transaksi atau layanan kami? ‚ú®</div>
        </div>
        
        <div class="quick-box">
            <div class="q-btn" onclick="askQuick('Bagaimana cara bayar?')">üí≥ Cara Bayar</div>
            <div class="q-btn" onclick="askQuick('Apakah aman beli di sini?')">üõ°Ô∏è Keamanan</div>
            <div class="q-btn" onclick="askQuick('Berapa lama akun dikirim?')">‚ö° Pengiriman</div>
            <div class="q-btn" onclick="askQuick('Metode pembayaran apa saja?')">üí∞ Metode</div>
        </div>

        <div class="chat-input">
            <input type="text" id="ai-input" placeholder="Tanya sesuatu..." onkeypress="if(event.key === 'Enter') askAI()">
            <button onclick="askAI()">Kirim</button>
        </div>
    </div>

    <div id="profile-modal" class="modal-custom hidden">
        <div class="modal-box">
            <h2 style="margin-bottom: 15px;">Pengaturan Profil</h2>
            <label style="font-size: 0.8rem; color: var(--text-sub);">Bio / Status</label>
            <textarea id="user-bio" rows="2" placeholder="Tulis sesuatu tentang kamu..."></textarea>
            
            <label style="font-size: 0.8rem; color: var(--text-sub); margin-top: 10px; display: block;">Ganti Password</label>
            <input type="password" id="new-password" placeholder="Password Baru">
            
            <button class="btn-buy" onclick="saveSettings()" style="margin-top: 15px;">Simpan Perubahan</button>
            <button onclick="logout()" style="width:100%; margin-top: 10px; padding: 10px; background:none; border:1px solid var(--danger); color:var(--danger); border-radius:12px; font-weight:700; cursor:pointer;">Keluar</button>
            <button onclick="closeProfile()" style="margin-top: 10px; background:none; border:none; color:var(--text-sub); width:100%; cursor:pointer;">Tutup</button>
        </div>
    </div>

    <div id="auth-modal" class="modal-custom hidden">
        <div class="modal-box">
            <h2 id="auth-title">Daftar Akun</h2>
            <input type="text" id="auth-user" placeholder="Username">
            <input type="password" id="auth-pass" placeholder="Password">
            <button class="btn-buy" onclick="handleAuth()">Konfirmasi</button>
            <p style="margin-top: 15px; font-size: 0.8rem; cursor:pointer;" onclick="toggleAuthMode()" id="toggle-text">Punya akun? Login</p>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCm--vENLF7tm40_YHg_1DWzExbAnH0",
            authDomain: "flutter-ai-playground-e9460.firebaseapp.com",
            databaseURL: "https://flutter-ai-playground-e9460-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "flutter-ai-playground-e9460",
            storageBucket: "flutter-ai-playground-e9460.appspot.com",
            messagingSenderId: "189868543960",
            appId: "1:189868543960:web:c732035483d92f6feecad"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let authMode = 'register';

        // THEME & ALERTS
        function toggleTheme() {
            const current = document.body.getAttribute('data-theme');
            const target = current === 'dark' ? 'light' : 'dark';
            document.body.setAttribute('data-theme', target);
            localStorage.setItem('theme', target);
        }

        function showAlert(text, type='error') {
            const box = document.getElementById('custom-alert');
            box.innerText = text;
            box.className = 'show alert-' + type;
            setTimeout(() => box.classList.remove('show'), 3000);
        }

        // AUTH
        function openAuth() { document.getElementById('auth-modal').classList.remove('hidden'); }
        function toggleAuthMode() {
            authMode = authMode === 'register' ? 'login' : 'register';
            document.getElementById('auth-title').innerText = authMode === 'register' ? 'Daftar Akun' : 'Login Akun';
            document.getElementById('toggle-text').innerText = authMode === 'register' ? 'Punya akun? Login' : 'Belum punya akun? Daftar';
        }

        async function handleAuth() {
            const user = document.getElementById('auth-user').value.toLowerCase().trim();
            const pass = document.getElementById('auth-pass').value.trim();
            if(!user || !pass) return showAlert("Isi semua kolom!");

            const userRef = db.ref('users/' + user);
            const snap = await userRef.once('value');

            if(authMode === 'register') {
                if(snap.val()) return showAlert("Username sudah dipakai!");
                await userRef.set({ password: btoa(pass), bio: "Member Baru Ranzz" });
                showAlert("Berhasil Daftar!", "success");
                toggleAuthMode();
            } else {
                const data = snap.val();
                if(data && atob(data.password) === pass) {
                    localStorage.setItem('isLoggedIn', user);
                    location.reload();
                } else showAlert("Username atau Password Salah!");
            }
        }

        // AI LOGIC v2.1 (Digital Knowledge)
        function toggleChat() {
            const chat = document.getElementById('ai-chat');
            chat.style.display = chat.style.display === 'flex' ? 'none' : 'flex';
        }

        function addChatMessage(role, text) {
            const content = document.getElementById('chat-content');
            const div = document.createElement('div');
            div.className = role === 'ai' ? 'msg-ai' : 'msg-user';
            div.innerText = text;
            content.appendChild(div);
            content.scrollTop = content.scrollHeight;
        }

        function askQuick(text) {
            document.getElementById('ai-input').value = text;
            askAI();
        }

        function askAI() {
            const input = document.getElementById('ai-input');
            const userMsg = input.value.trim();
            if(!userMsg) return;

            addChatMessage('user', userMsg);
            input.value = "";

            setTimeout(() => {
                const lowMsg = userMsg.toLowerCase();
                let response = "Mohon maaf, saya belum memahami pertanyaan tersebut. Bisa coba tanyakan tentang 'pembayaran', 'garansi', atau 'cara order'?";

                if(lowMsg.includes("bayar") || lowMsg.includes("pembayaran")) {
                    response = "Untuk pembayaran, kami menerima:\n1. DANA/OVO/GoPay\n2. Transfer Bank (BCA/BRI)\n3. QRIS (Semua Bank/E-Wallet).\nSilakan pilih produk dan klik tombol beli!";
                } else if(lowMsg.includes("cara beli") || lowMsg.includes("order")) {
                    response = "1. Pilih akun yang diinginkan.\n2. Klik 'Beli Sekarang'.\n3. Kirim pesan ke Gmail Admin.\n4. Lakukan pembayaran.\n5. Akun akan langsung dikirim oleh admin.";
                } else if(lowMsg.includes("aman") || lowMsg.includes("garansi") || lowMsg.includes("legal")) {
                    response = "Tentu! Semua akun kami 100% legal dan bergaransi selama 30 hari jika terjadi masalah (bukan kesalahan buyer). Kami adalah toko terverifikasi.";
                } else if(lowMsg.includes("berapa lama") || lowMsg.includes("pengiriman") || lowMsg.includes("kapan")) {
                    response = "Pengiriman sangat cepat! Setelah bukti pembayaran dikirim, admin akan memproses data akun dalam waktu 5-15 menit.";
                } else if(lowMsg.includes("halo") || lowMsg.includes("p")) {
                    response = "Halo! Saya asisten RANZZ_JB. Ada yang bisa dibantu mengenai pembayaran atau detail akun?";
                } else if(lowMsg.includes("diskon") || lowMsg.includes("murah")) {
                    response = "Kami sering mengadakan promo! Cek berkala halaman ini atau tanyakan langsung ke admin untuk harga spesial pembelian pertama.";
                }

                addChatMessage('ai', response);
            }, 600);
        }

        // PROFILE & SETTINGS
        function openProfile() { document.getElementById('profile-modal').classList.remove('hidden'); }
        function closeProfile() { document.getElementById('profile-modal').classList.add('hidden'); }

        async function saveSettings() {
            const user = localStorage.getItem('isLoggedIn');
            const newBio = document.getElementById('user-bio').value;
            const newPass = document.getElementById('new-password').value;
            
            let updateData = { bio: newBio };
            if(newPass) updateData.password = btoa(newPass);

            await db.ref('users/' + user).update(updateData);
            showAlert("Profil berhasil disimpan!", "success");
            setTimeout(closeProfile, 1000);
        }

        function logout() { localStorage.removeItem('isLoggedIn'); location.reload(); }

        function orderViaGmail(p, pr) {
            const user = localStorage.getItem('isLoggedIn');
            if(!user) return openAuth();
            window.location.href = `mailto:gustiranggayoni06@gmail.com?subject=Beli ${p}&body=User: ${user} ingin membeli ${p} seharga ${pr}. Mohon instruksi pembayaran admin.`;
        }

        window.onload = async () => {
            const user = localStorage.getItem('isLoggedIn');
            if(user) {
                document.getElementById('btn-login-init').classList.add('hidden');
                document.getElementById('user-info').classList.remove('hidden');
                document.getElementById('user-name').innerText = user;
                const snap = await db.ref('users/' + user).once('value');
                if(snap.val() && snap.val().bio) document.getElementById('user-bio').value = snap.val().bio;
            }
        }
    </script>
</body>
</html>
